(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-ucenter-addressAdd-addressAdd"],{"01dc":function(e,t,i){"use strict";i.r(t);var n=i("74b9"),s=i("9049");for(var a in s)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return s[e]}))}(a);i("e2d3");var d=i("f0c5"),o=Object(d["a"])(s["default"],n["b"],n["c"],!1,null,"38f7bbb0",null,!1,n["a"],void 0);t["default"]=o.exports},2771:function(e,t){var i="http://192.168.1.114:8360/api/";e.exports={ApiRootUrl:i,IndexUrl:i+"index/index",CatalogList:i+"catalog/index",CatalogCurrent:i+"catalog/current",AuthLoginByWeixin:i+"auth/loginByWeixin",GoodsCount:i+"goods/count",GoodsList:i+"goods/list",GoodsCategory:i+"goods/category",GoodsDetail:i+"goods/detail",GoodsNew:i+"goods/new",GoodsHot:i+"goods/hot",GoodsRelated:i+"goods/related",BrandList:i+"brand/list",BrandDetail:i+"brand/detail",CartList:i+"cart/index",CartAdd:i+"cart/add",CartUpdate:i+"cart/update",CartDelete:i+"cart/delete",CartChecked:i+"cart/checked",CartGoodsCount:i+"cart/goodscount",CartCheckout:i+"cart/checkout",OrderSubmit:i+"order/submit",PayPrepayId:i+"pay/prepay",CollectList:i+"collect/list",CollectAddOrDelete:i+"collect/addordelete",CommentList:i+"comment/list",CommentCount:i+"comment/count",CommentPost:i+"comment/post",TopicList:i+"topic/list",TopicDetail:i+"topic/detail",TopicRelated:i+"topic/related",SearchIndex:i+"search/index",SearchResult:i+"search/result",SearchHelper:i+"search/helper",SearchClearHistory:i+"search/clearhistory",AddressList:i+"address/list",AddressDetail:i+"address/detail",AddressSave:i+"address/save",AddressDelete:i+"address/delete",RegionList:i+"region/list",OrderList:i+"order/list",OrderDetail:i+"order/detail",OrderCancel:i+"order/cancel",OrderExpress:i+"order/express",FootprintList:i+"footprint/list",FootprintDelete:i+"footprint/delete"}},"288e":function(e,t,i){"use strict";(function(e){i("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("d3b7"),i("d81d");var n=i("2e67"),s=i("2771"),a=(getApp(),{data:function(){return{address:{id:0,province_id:0,city_id:0,district_id:0,address:"",full_region:"",name:"",mobile:"",is_default:0},addressId:0,openSelectRegion:!1,selectRegionList:[{id:0,name:"省份",parent_id:1,type:1},{id:0,name:"城市",parent_id:1,type:2},{id:0,name:"区县",parent_id:1,type:3}],regionType:1,regionList:[],selectRegionDone:!1}},onLoad:function(t){e("log",t," at pages/ucenter/addressAdd/addressAdd.vue:110"),t.id&&(this.setData({addressId:t.id}),this.getAddressDetail()),this.getRegionList(1)},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},methods:{bindinputMobile:function(e){var t=this.address;t.mobile=e.detail.value,this.setData({address:t})},bindinputName:function(e){var t=this.address;t.name=e.detail.value,this.setData({address:t})},bindinputAddress:function(e){var t=this.address;t.address=e.detail.value,this.setData({address:t})},bindIsDefault:function(){var e=this.address;e.is_default=!e.is_default,this.setData({address:e})},getAddressDetail:function(){var e=this;n.request(s.AddressDetail,{id:e.addressId}).then((function(t){0===t.errno&&e.setData({address:t.data})}))},setRegionDoneStatus:function(){var e=this.selectRegionList.every((function(e){return 0!=e.id}));this.setData({selectRegionDone:e})},chooseRegion:function(){this.setData({openSelectRegion:!this.openSelectRegion});var e=this.address;if(e.province_id>0&&e.city_id>0&&e.district_id>0){var t=this.selectRegionList;t[0].id=e.province_id,t[0].name=e.province_name,t[0].parent_id=1,t[1].id=e.city_id,t[1].name=e.city_name,t[1].parent_id=e.province_id,t[2].id=e.district_id,t[2].name=e.district_name,t[2].parent_id=e.city_id,this.setData({selectRegionList:t,regionType:3}),this.getRegionList(e.city_id)}else this.setData({selectRegionList:[{id:0,name:"省份",parent_id:1,type:1},{id:0,name:"城市",parent_id:1,type:2},{id:0,name:"区县",parent_id:1,type:3}],regionType:1}),this.getRegionList(1);this.setRegionDoneStatus()},selectRegionType:function(e){var t=e.target.dataset.regionTypeIndex,i=this.selectRegionList;if(t+1==this.regionType||t-1>=0&&i[t-1].id<=0)return!1;this.setData({regionType:t+1});var n=i[t];this.getRegionList(n.parent_id),this.setRegionDoneStatus()},selectRegion:function(e){var t=this,i=e.target.dataset.regionIndex,n=this.regionList[i],s=n.type,a=this.selectRegionList;a[s-1]=n,3!=s?(this.setData({selectRegionList:a,regionType:s+1}),this.getRegionList(n.id)):this.setData({selectRegionList:a}),a.map((function(e,t){return t>s-1&&(e.id=0,e.name=1==t?"城市":"区县",e.parent_id=0),e})),this.setData({selectRegionList:a}),t.setData({regionList:t.regionList.map((function(e){return t.regionType==e.type&&t.selectRegionList[t.regionType-1].id==e.id?e.selected=!0:e.selected=!1,e}))}),this.setRegionDoneStatus()},doneSelectRegion:function(){if(!1===this.selectRegionDone)return!1;var e=this.address,t=this.selectRegionList;e.province_id=t[0].id,e.city_id=t[1].id,e.district_id=t[2].id,e.province_name=t[0].name,e.city_name=t[1].name,e.district_name=t[2].name,e.full_region=t.map((function(e){return e.name})).join(""),this.setData({address:e,openSelectRegion:!1})},cancelSelectRegion:function(){this.setData({openSelectRegion:!1,regionType:this.regionDoneStatus?3:1})},getRegionList:function(e){var t=this,i=t.regionType;n.request(s.RegionList,{parentId:e}).then((function(e){0===e.errno&&t.setData({regionList:e.data.map((function(e){return i==e.type&&t.selectRegionList[i-1].id==e.id?e.selected=!0:e.selected=!1,e}))})}))},cancelAddress:function(){uni.navigateTo({url:"/pages/ucenter/address/address"})},saveAddress:function(){e("log",this.address," at pages/ucenter/addressAdd/addressAdd.vue:372");var t=this.address;if(""==t.name)return n.showErrorToast("请输入姓名"),!1;if(""==t.mobile)return n.showErrorToast("请输入手机号码"),!1;if(0==t.district_id)return n.showErrorToast("请输入省市区"),!1;if(""==t.address)return n.showErrorToast("请输入详细地址"),!1;n.request(s.AddressSave,{id:t.id,name:t.name,mobile:t.mobile,province_id:t.province_id,city_id:t.city_id,district_id:t.district_id,address:t.address,is_default:t.is_default},"POST").then((function(e){0===e.errno&&uni.navigateTo({url:"/pages/ucenter/address/address"})}))}}});t.default=a}).call(this,i("0de9")["log"])},"2e67":function(e,t,i){(function(t){i("d81d"),i("d401"),i("d3b7"),i("25f0");var n=i("2771");function s(e){return e=e.toString(),e[1]?e:"0"+e}function a(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(r,c){uni.request({url:e,data:i,method:s,header:{"Content-Type":"application/json","X-Nideshop-Token":uni.getStorageSync("token")},success:function(e){if(t("log","success"," at utils/util.js:32"),200==e.statusCode){if(401==e.data.errno){var i=null;return d().then((function(e){return i=e.code,o()})).then((function(e){a(n.AuthLoginByWeixin,{code:i,userInfo:e},"POST").then((function(e){0===e.errno?(uni.setStorageSync("userInfo",e.data.userInfo),uni.setStorageSync("token",e.data.token),r(e)):c(e)})).catch((function(e){c(e)}))})).catch((function(e){c(e)}))}r(e.data)}else c(e.errMsg)},fail:function(e){c(e),t("log","failed"," at utils/util.js:79")}})}))}function d(){return new Promise((function(e,t){uni.login({success:function(i){i.code?e(i.code):t(i)},fail:function(e){t(e)}})}))}function o(){return new Promise((function(e,t){uni.getUserInfo({withCredentials:!0,success:function(i){"getUserInfo:ok"===i.detail.errMsg?e(i):t(i)},fail:function(e){t(e)}})}))}e.exports={formatTime:function(e){var t=e.getFullYear(),i=e.getMonth()+1,n=e.getDate(),a=e.getHours(),d=e.getMinutes(),o=e.getSeconds();return[t,i,n].map(s).join("-")+" "+[a,d,o].map(s).join(":")},request:a,get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e,t,"GET")},post:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a(e,t,"POST")},redirect:function(e){uni.redirectTo({url:e})},showErrorToast:function(e){uni.showToast({title:e,image:"/static/static/images/icon_error.png"})},checkSession:function(){return new Promise((function(e,t){uni.checkSession({success:function(){e(!0)},fail:function(){t(!1)}})}))},login:d,getUserInfo:o}}).call(this,i("0de9")["log"])},"74b9":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",[i("v-uni-view",{staticClass:"add-address"},[i("v-uni-view",{staticClass:"add-form"},[i("v-uni-view",{staticClass:"form-item"},[i("v-uni-input",{staticClass:"input",attrs:{placeholder:"姓名",value:e.address.name,"auto-focus":!0},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.bindinputName.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-input",{staticClass:"input",attrs:{value:e.address.mobile,placeholder:"手机号码"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.bindinputMobile.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-input",{staticClass:"input",attrs:{value:e.address.full_region,disabled:!0,placeholder:"省份、城市、区县"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseRegion.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-input",{staticClass:"input",attrs:{value:e.address.address,placeholder:"详细地址, 如街道、楼盘号等"},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.bindinputAddress.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"form-default"},[i("v-uni-text",{class:"default-input "+(1==e.address.is_default?"selected":""),on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.bindIsDefault.apply(void 0,arguments)}}},[e._v("设为默认地址")])],1)],1),i("v-uni-view",{staticClass:"btns"},[i("v-uni-button",{staticClass:"cannel",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancelAddress.apply(void 0,arguments)}}},[e._v("取消")]),i("v-uni-button",{staticClass:"save",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.saveAddress.apply(void 0,arguments)}}},[e._v("保存")])],1),e.openSelectRegion?i("v-uni-view",{staticClass:"region-select"},[i("v-uni-view",{staticClass:"hd"},[i("v-uni-view",{staticClass:"region-selected"},e._l(e.selectRegionList,(function(t,n){return i("v-uni-view",{key:t.id,class:"item "+(0==t.id?"disabled":"")+" "+(e.regionType-1===n?"selected":""),attrs:{"data-region-type-index":n},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectRegionType.apply(void 0,arguments)}}},[e._v(e._s(t.name))])})),1),i("v-uni-view",{class:"done "+(e.selectRegionDone?"":"disabled"),on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.doneSelectRegion.apply(void 0,arguments)}}},[e._v("确定")])],1),i("v-uni-view",{staticClass:"bd"},[i("v-uni-view",{staticClass:"region-list"},e._l(e.regionList,(function(t,n){return i("v-uni-view",{key:t.id,class:"item "+(t.selected?"selected":""),attrs:{"data-region-index":n},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectRegion.apply(void 0,arguments)}}},[e._v(e._s(t.name))])})),1)],1)],1):e._e()],1),e.openSelectRegion?i("v-uni-view",{staticClass:"bg-mask",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancelSelectRegion.apply(void 0,arguments)}}}):e._e()],1)},s=[]},9049:function(e,t,i){"use strict";i.r(t);var n=i("288e"),s=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=s.a},df80:function(e,t,i){var n=i("f682");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var s=i("4f06").default;s("03841133",n,!0,{sourceMap:!1,shadowMode:!1})},e2d3:function(e,t,i){"use strict";var n=i("df80"),s=i.n(n);s.a},f682:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,"uni-page-body[data-v-38f7bbb0]{height:100%;background:#f4f4f4}body.?%PAGE?%[data-v-38f7bbb0]{background:#f4f4f4}.add-address .add-form[data-v-38f7bbb0]{background:#fff;width:100%;height:auto;overflow:hidden}.add-address .form-item[data-v-38f7bbb0]{height:%?116?%;padding-left:%?31.25?%;border-bottom:1px solid #d9d9d9;display:flex;align-items:center;padding-right:%?31.25?%}.add-address .input[data-v-38f7bbb0]{flex:1;height:%?44?%;line-height:%?44?%;overflow:hidden}.add-address .form-default[data-v-38f7bbb0]{border-bottom:1px solid #d9d9d9;height:%?96?%;background:#fafafa;padding-top:%?28?%;font-size:%?28?%}.default-input[data-v-38f7bbb0]{margin:0 auto;display:block;width:%?240?%;height:%?40?%;padding-left:%?50?%;line-height:%?40?%;background:url(http://yanxuan.nosdn.127.net/hxm/yanxuan-wap/p/20161201/style/img/sprites/checkbox-sed825af9d3-a6b8540d42.png) %?1?% %?-448?% no-repeat;background-size:%?38?% %?486?%;font-size:%?28?%}.default-input.selected[data-v-38f7bbb0]{background:url(http://yanxuan.nosdn.127.net/hxm/yanxuan-wap/p/20161201/style/img/sprites/checkbox-sed825af9d3-a6b8540d42.png) 0 %?-192?% no-repeat;background-size:%?38?% %?486?%}.add-address .btns[data-v-38f7bbb0]{position:fixed;bottom:0;left:0;overflow:hidden;display:flex;height:%?100?%;width:100%}.add-address .cannel[data-v-38f7bbb0],\n.add-address .save[data-v-38f7bbb0]{flex:1;height:%?100?%;text-align:center;line-height:%?100?%;font-size:%?28?%;color:#fff;border:none;border-radius:0}.add-address .cannel[data-v-38f7bbb0]{background:#333}.add-address .save[data-v-38f7bbb0]{background:#b4282d}.region-select[data-v-38f7bbb0]{width:100%;height:%?600?%;background:#fff;position:fixed;z-index:10;left:0;bottom:0}.region-select .hd[data-v-38f7bbb0]{height:%?108?%;width:100%;border-bottom:1px solid #f4f4f4;padding:%?46?% %?30?% 0 %?30?%}.region-select .region-selected[data-v-38f7bbb0]{float:left;height:%?60?%;display:flex}.region-select .region-selected .item[data-v-38f7bbb0]{max-width:%?140?%;margin-right:%?30?%;text-align:left;line-height:%?60?%;height:100%;color:#333;font-size:%?28?%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.region-select .region-selected .item.disabled[data-v-38f7bbb0]{color:#999}.region-select .region-selected .item.selected[data-v-38f7bbb0]{color:#b4282d}.region-select .done[data-v-38f7bbb0]{float:right;height:%?60?%;width:%?60?%;border:none;background:#fff;line-height:%?60?%;text-align:center;color:#333;font-size:%?28?%}.region-select .done.disabled[data-v-38f7bbb0]{color:#999}.region-select .bd[data-v-38f7bbb0]{height:%?492?%;width:100%;padding:0 %?30?%}.region-select .region-list[data-v-38f7bbb0]{height:auto;overflow:scroll}.region-select .region-list .item[data-v-38f7bbb0]{width:100%;height:%?104?%;line-height:%?104?%;text-align:left;color:#333;font-size:%?28?%}.region-select .region-list .item.selected[data-v-38f7bbb0]{color:#b4282d}.bg-mask[data-v-38f7bbb0]{height:100%;width:100%;background:rgba(0,0,0,.4);position:fixed;top:0;left:0;z-index:8}",""]),e.exports=t}}]);