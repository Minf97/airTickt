{"version":3,"sources":["uni-app:///main.js","webpack:////Users/un/Desktop/1-15-nideshop 2-1/pages/goods/goods.vue?729f","webpack:////Users/un/Desktop/1-15-nideshop 2-1/pages/goods/goods.vue?6927","webpack:////Users/un/Desktop/1-15-nideshop 2-1/pages/goods/goods.vue?05f2","webpack:////Users/un/Desktop/1-15-nideshop 2-1/pages/goods/goods.vue?a4db","uni-app:///pages/goods/goods.vue","webpack:////Users/un/Desktop/1-15-nideshop 2-1/pages/goods/goods.vue?d121"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","renderjs","component","options","__file","components","mpHtml","uniCalendar","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","data","id","retail_price","goods","name","goods_brief","gallery","attribute","issueList","comment","brand","brandId","specificationList","productList","relatedGoods","cartGoodsCount","userHasCollect","number","checkedSpecText","openAttr","noCollectImage","hasCollectImage","collectBackImage","avatar","nickname","add_time","content","pic_list","article_goodsDetail","img_url","vitem","checked","specification_id","value","buyText","chooseDate","chooseId","ischoose","timearr","onLoad","util","that","onReady","onShow","onHide","onUnload","methods","getRetailPrice","getWeekendPrice","open","uni","title","icon","duration","naviTo","url","buy","isWeekend","addToCart","checkedProduct","api","goodsId","productId","category_id","certification","then","image","mask","goodsClear","productDlete","goods_id","submitOrder","addressId","couponId","isNoNeedAddress","phone","pay","orderId","catch","handleTime","a","b","result","start","confirm","currentTarget","dataset","nameId","valueId","date","getGoodsInfo","shiJian","iitem","i","shiJianArr","info","timearrCopy","getGoodsRelated","clickSkuValue","findId","String","getCheckedSpecValue","valueText","_checkedObj","checkedValues","setChecked","targetSpecification","item","setSpecValueStatus","isCheckedAllSpec","getCheckedSpecKey","changeSpecInfo","filter","map","getCheckedProductItem","sort","JSON","switchAttrPop","closeAttr","addCannelCollect","typeId","openCartPage","cutNumber","addNumber"],"mappings":"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","file":"pages/goods/goods.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/goods/goods.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./goods.vue?vue&type=template&id=5566b618&\"\nvar renderjs\nimport script from \"./goods.vue?vue&type=script&lang=js&\"\nexport * from \"./goods.vue?vue&type=script&lang=js&\"\nimport style0 from \"./goods.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/goods/goods.vue\"\nexport default component.exports","export * from \"-!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./goods.vue?vue&type=template&id=5566b618&\"","var components\ntry {\n  components = {\n    mpHtml: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/mp-html/components/mp-html/mp-html\" */ \"@/uni_modules/mp-html/components/mp-html/mp-html.vue\"\n      )\n    },\n    uniCalendar: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-calendar/components/uni-calendar/uni-calendar\" */ \"@/uni_modules/uni-calendar/components/uni-calendar/uni-calendar.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./goods.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./goods.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view class=\"container\">\r\n\t\t\t<swiper class=\"goodsimgs\" :indicator-dots=\"true\" :autoplay=\"true\" interval=\"3000\" duration=\"1000\">\r\n\t\t\t\t<swiper-item v-for=\"(item, index) in gallery\" :key=\"item.id\">\r\n\t\t\t\t\t<image :src=\"item.img_url\" background-size=\"cover\"></image>\r\n\t\t\t\t</swiper-item>\r\n\t\t\t</swiper>\r\n\t\t\t<!-- <view class=\"service-policy\">\r\n                <view class=\"item\">30天无忧退货</view>\r\n                <view class=\"item\">48小时快速退款</view>\r\n                <view class=\"item\">满88元免邮费</view>\r\n            </view> -->\r\n\t\t\t<view class=\"goods-info\">\r\n\t\t\t\t<view class=\"c\">\r\n\t\t\t\t\t<text class=\"name\">{{ goods.name }}</text>\r\n\t\t\t\t\t<text class=\"desc\">{{ goods.goods_brief }}</text>\r\n\t\t\t\t\t<text class=\"price\">￥{{ goods.retail_price }}</text>\r\n\t\t\t\t\t<view class=\"brand\" v-if=\"brand.name\">\r\n\t\t\t\t\t\t<navigator :url=\"'../brandDetail/brandDetail?id=' + brand.brandId\">\r\n\t\t\t\t\t\t\t<text>{{ brand.name }}</text>\r\n\t\t\t\t\t\t</navigator>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"section-nav section-attr\" @tap=\"switchAttrPop\">\r\n\t\t\t\t<view class=\"t\">请选择规格数量</view>\r\n\t\t\t\t<image class=\"i\" src=\"/static/static/images/address_right.png\" background-size=\"cover\"></image>\r\n\t\t\t</view>\r\n\t\t\t<!--<view class=\"section-nav section-act\">\r\n      <view class=\"t\">\r\n        <view class=\"label\">1个促销:</view>\r\n        <view class=\"tag\">万圣趴</view>\r\n        <view class=\"text\">全场满499，额外送糖果</view>\r\n      </view>\r\n      <image class=\"i\" src=\"../../static/images/address_right.png\" background-size=\"cover\"></image>\r\n    </view>-->\r\n\t\t\t<view class=\"comments\" v-if=\"comment.count > 0\">\r\n\t\t\t\t<view class=\"h\">\r\n\t\t\t\t\t<navigator :url=\"'../comment/comment?valueId=' + goods.id + '&typeId=0'\">\r\n\t\t\t\t\t\t<text class=\"t\">评价({{ comment.count > 999 ? '999+' : comment.count }})</text>\r\n\t\t\t\t\t\t<text class=\"i\">查看全部</text>\r\n\t\t\t\t\t</navigator>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"b\">\r\n\t\t\t\t\t<view class=\"item\">\r\n\t\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t\t<view class=\"user\">\r\n\t\t\t\t\t\t\t\t<image :src=\"comment.data.avatar\"></image>\r\n\t\t\t\t\t\t\t\t<text>{{ comment.data.nickname }}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"time\">{{ comment.data.add_time }}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t\t{{ comment.data.content }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"imgs\" v-if=\"comment.data.pic_list.length > 0\">\r\n\t\t\t\t\t\t\t<image class=\"img\" :src=\"item.pic_url\" v-for=\"(item, index) in comment.data.pic_list\"\r\n\t\t\t\t\t\t\t\t:key=\"item.id\"></image>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<!-- <view class=\"spec\">白色 2件</view> -->\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"goods-attr\">\r\n\t\t\t\t<view class=\"t\">商品参数</view>\r\n\t\t\t\t<view class=\"l\">\r\n\t\t\t\t\t<view class=\"item\" v-for=\"(item, index) in attribute\" :key=\"item.name\">\r\n\t\t\t\t\t\t<text class=\"left\">{{ item.name }}</text>\r\n\r\n\t\t\t\t\t\t<text class=\"right\">{{ item.value }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"detail\" style=\"background-color: #fff;\">\r\n\t\t\t\t<!-- <template is=\"wxParse\" :data=\"wxParseData:goodsDetail.nodes\"/> -->\r\n\t\t\t\t<mp-html :content=\"article_goodsDetail\"></mp-html>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"common-problem\">\r\n\t\t\t\t<view class=\"h\">\r\n\t\t\t\t\t<view class=\"line\"></view>\r\n\t\t\t\t\t<text class=\"title\">常见问题</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"b\">\r\n\t\t\t\t\t<view class=\"item\" v-for=\"(item, index) in issueList\" :key=\"item.id\">\r\n\t\t\t\t\t\t<view class=\"question-box\">\r\n\t\t\t\t\t\t\t<text class=\"spot\"></text>\r\n\t\t\t\t\t\t\t<text class=\"question\">{{ item.question }}</text>\r\n\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t<view class=\"answer\">\r\n\t\t\t\t\t\t\t{{ item.answer }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"related-goods\" v-if=\"relatedGoods.length > 0\">\r\n\t\t\t\t<view class=\"h\">\r\n\t\t\t\t\t<view class=\"line\"></view>\r\n\t\t\t\t\t<text class=\"title\">大家都在看</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"b\">\r\n\t\t\t\t\t<view class=\"item\" v-for=\"(item, index) in relatedGoods\" :key=\"item.id\">\r\n\t\t\t\t\t\t<navigator :url=\"'/pages/goods/goods?id=' + item.id\">\r\n\t\t\t\t\t\t\t<image class=\"img\" :src=\"item.list_pic_url\" background-size=\"cover\"></image>\r\n\t\t\t\t\t\t\t<text class=\"name\">{{ item.name }}</text>\r\n\t\t\t\t\t\t\t<text class=\"price\">￥{{ item.retail_price }}</text>\r\n\t\t\t\t\t\t</navigator>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"attr-pop-box\" v-if=\"openAttr\">\r\n\t\t\t<view class=\"attr-pop\">\r\n\t\t\t\t<view class=\"close\" @tap=\"closeAttr\">\r\n\t\t\t\t\t<image class=\"icon\" src=\"/static/static/images/icon_close.png\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"img-info\">\r\n\t\t\t\t\t<image class=\"img\" :src=\"gallery[0].img_url\"></image>\r\n\t\t\t\t\t<view class=\"info\">\r\n\t\t\t\t\t\t<view class=\"c\">\r\n\t\t\t\t\t\t\t<view class=\"p\">价格：￥{{ retail_price || goods.retail_price }}</view>\r\n\t\t\t\t\t\t\t<view class=\"a\" v-if=\"productList.length > 0\">已选择：{{ checkedSpecText }}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"spec-con\">\r\n\t\t\t\t\t<view class=\"spec-item\" v-for=\"(item, index) in specificationList\" :key=\"item.specification_id\">\r\n\t\t\t\t\t\t<view class=\"name\">{{ item.name }}</view>\r\n\t\t\t\t\t\t<view class=\"values\">\r\n\t\t\t\t\t\t\t<view v-if=\"item.name != '时间'\">\r\n\t\t\t\t\t\t\t\t<view :class=\"'value ' + (vitem.checked ? 'selected' : '')\" @tap=\"clickSkuValue\"\r\n\t\t\t\t\t\t\t\t\t:data-value-id=\"vitem.id\" :data-name-id=\"vitem.specification_id\"\r\n\t\t\t\t\t\t\t\t\tv-for=\"(vitem, index1) in item.valueList\" :key=\"vitem.id\">\r\n\t\t\t\t\t\t\t\t\t{{ vitem.value }}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t\t\t<view v-if=\"item.name == '时间'\">\r\n\t\t\t\t\t\t\t\t<uni-calendar ref=\"calendar\" :selected=\"timearr\" :insert=\"false\" @confirm=\"confirm\" />\r\n\t\t\t\t\t\t\t\t<view :class=\"'value ' + (chooseDate == '选择日期' ? '':'selected')\"\r\n\t\t\t\t\t\t\t\t\t:style=\"chooseId == 0 ? 'border: 1px solid #ccc;color:#ccc' : ''\"\r\n\t\t\t\t\t\t\t\t\t:data-value-id=\"vitem.id\" :data-name-id=\"vitem.specification_id\" @click=\"open\">\r\n\t\t\t\t\t\t\t\t\t{{chooseDate}}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\r\n\t\t\t\t\t<!-- <view class=\"number-item\">\r\n\t\t\t\t\t\t<view class=\"name\">数量</view>\r\n\t\t\t\t\t\t<view class=\"selnum\">\r\n\t\t\t\t\t\t\t<view class=\"cut\" @tap=\"cutNumber\">-</view>\r\n\t\t\t\t\t\t\t<input :value=\"number\" class=\"number\" :disabled=\"true\" type=\"number\" />\r\n\t\t\t\t\t\t\t<view class=\"add\" @tap=\"addNumber\">+</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"bottom-btn\">\r\n\t\t\t<view class=\"l l-collect\" @tap=\"addCannelCollect\">\r\n\t\t\t\t<image class=\"icon\" :src=\"collectBackImage\"></image>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"l l-cart\">\r\n\t\t\t\t<view class=\"box\">\r\n\t\t\t\t\t<text class=\"cart-count\">{{ cartGoodsCount }}</text>\r\n\t\t\t\t\t<image @tap=\"openCartPage\" class=\"icon\" src=\"/static/static/images/ic_menu_shoping_nor.png\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"c\" style=\"opacity: 0\">立即购买</view>\r\n\t\t\t<!-- <view class=\"r\" @tap=\"addToCart\">加入购物车</view> -->\r\n\t\t\t<view class=\"r\" @tap=\"buy\"\r\n\t\t\t\t:style=\"(chooseDate == '选择日期' || chooseId == 0) && buyText == '立即购买' && goods.category_id == 1036010  ? 'border: 1px solid #ccc;background-color: #fff;color:#ccc' : ''\">\r\n\t\t\t\t{{buyText}}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n<script>\r\n\tvar app = getApp();\r\n\r\n\tvar undefined;\r\n\r\n\tvar util = require('../../utils/util.js');\r\n\r\n\tvar api = require('../../config/api.js');\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tid: 0,\r\n\t\t\t\tretail_price: '',\r\n\t\t\t\tgoods: {\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tgoods_brief: '',\r\n\t\t\t\t\tretail_price: '',\r\n\t\t\t\t\tid: ''\r\n\t\t\t\t},\r\n\r\n\t\t\t\tgallery: [],\r\n\t\t\t\tattribute: [],\r\n\t\t\t\tissueList: [],\r\n\t\t\t\tcomment: [],\r\n\r\n\t\t\t\tbrand: {\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\tbrandId: ''\r\n\t\t\t\t},\r\n\r\n\t\t\t\tspecificationList: [],\r\n\t\t\t\tproductList: [],\r\n\t\t\t\trelatedGoods: [],\r\n\t\t\t\tcartGoodsCount: 0,\r\n\t\t\t\tuserHasCollect: 0,\r\n\t\t\t\tnumber: 1,\r\n\t\t\t\tcheckedSpecText: '请选择规格数量',\r\n\t\t\t\topenAttr: false,\r\n\t\t\t\tnoCollectImage: '/static/static/images/icon_collect.png',\r\n\t\t\t\thasCollectImage: '/static/static/images/icon_collect_checked.png',\r\n\t\t\t\tcollectBackImage: '/static/static/images/icon_collect.png',\r\n\t\t\t\tavatar: '',\r\n\t\t\t\tnickname: '',\r\n\t\t\t\tadd_time: '',\r\n\t\t\t\tcontent: '',\r\n\t\t\t\tpic_list: [],\r\n\t\t\t\tarticle_goodsDetail: '',\r\n\t\t\t\timg_url: '',\r\n\r\n\t\t\t\tvitem: {\r\n\t\t\t\t\tchecked: false,\r\n\t\t\t\t\tid: '',\r\n\t\t\t\t\tspecification_id: '',\r\n\t\t\t\t\tvalue: ''\r\n\t\t\t\t},\r\n\t\t\t\tbuyText: \"选择规格\",\r\n\t\t\t\tchooseDate: \"选择日期\",\r\n\r\n\t\t\t\tchooseId: 0,\r\n\t\t\t\tischoose: false,\r\n\t\t\t\ttimearr: [],\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad: function(options) {\r\n\t\t\t// 页面初始化 options为页面跳转所带来的参数\r\n\t\t\tthis.setData({\r\n\t\t\t\tid: parseInt(options.id) // id: 1181000\r\n\t\t\t});\r\n\t\t\tvar that = this;\r\n\t\t\tthis.getGoodsInfo();\r\n\t\t\tutil.request(api.CartGoodsCount).then(function(res) {\r\n\t\t\t\tif (res.errno === 0) {\r\n\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\tcartGoodsCount: res.data.cartTotal.goodsCount\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tonReady: function() {\r\n\t\t\t// 页面渲染完成\r\n\t\t},\r\n\t\tonShow: function() {\r\n\t\t\t// 页面显示\r\n\t\t},\r\n\t\tonHide: function() {\r\n\t\t\t// 页面隐藏\r\n\t\t},\r\n\t\tonUnload: function() {\r\n\t\t\t// 页面关闭\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetRetailPrice(productList, id) {\r\n\t\t\t\tfor (let i = 0; i < productList.length; i++) {\r\n\t\t\t\t\tlet product = productList[i];\r\n\t\t\t\t\tif (product.goods_specification_ids && product.goods_specification_ids.includes(id)) {\r\n\t\t\t\t\t\treturn product.retail_price;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\t\t\tgetWeekendPrice(productList, id) {\r\n\t\t\t\tfor (let i = 0; i < productList.length; i++) {\r\n\t\t\t\t\tlet product = productList[i];\r\n\t\t\t\t\tif (product.goods_specification_ids && product.goods_specification_ids.includes(id)) {\r\n\t\t\t\t\t\treturn product.weekend_price;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\t\t\topen() {\r\n\t\t\t\tif (this.chooseId == 0) {\r\n\t\t\t\t\t// util.showErrorToast('请先选择规格')\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请先选择规格',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 要寻找的id\r\n\t\t\t\tconst id = this.findId();\r\n\t\t\t\tconsole.log(id, \"要找的时间的id\");\r\n\t\t\t\tconst timearrCopy = this.timearrCopy;\r\n\t\t\t\tlet result = timearrCopy.filter(item => {\r\n\t\t\t\t\t// return item.filter(value => value.id == id);\r\n\t\t\t\t\t// if (item.id == id) {\r\n\t\t\t\t\t// \treturn item\r\n\t\t\t\t\t// }\r\n\t\t\t\t\treturn item.id == id\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconsole.log(result);\r\n\r\n\t\t\t\t// for (const i of result) {\r\n\t\t\t\t// \tif (i.length != 0) {\r\n\t\t\t\t// \t\tresult = i;\r\n\t\t\t\t// \t}\r\n\t\t\t\t// }\r\n\t\t\t\t// console.log(id, specificationList, result);\r\n\t\t\t\tthis.timearr = result;\r\n\t\t\t\tthis.$refs.calendar[0].open();\r\n\t\t\t},\r\n\t\t\tnaviTo() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/shopping/checkoutNew/checkoutNew?category_id=' + this.goods.category_id +\r\n\t\t\t\t\t\t'&choosetime=' + this.chooseDate\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync buy() {\r\n\t\t\t\tif (this.buyText == \"选择规格\") {\r\n\t\t\t\t\tthis.openAttr = true;\r\n\t\t\t\t\tthis.buyText = \"立即购买\";\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst chooseDate = this.chooseDate;\r\n\t\t\t\tconst chooseId = this.chooseId;\r\n\t\t\t\tconst buyText = this.buyText;\r\n\r\n\t\t\t\tif ((chooseDate == '选择日期' || chooseId == 0) && buyText == '立即购买' && this.goods.category_id == 1036010) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '还没选择好噢',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tuni.showLoading();\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// 删除购物车中的该类商品\r\n\t\t\t\t\tawait this.productDlete();\r\n\t\t\t\t\t// 购物车置空\r\n\t\t\t\t\tawait this.goodsClear();\r\n\t\t\t\t\t// 加入购物车\r\n\t\t\t\t\tlet isWeekend = this.isWeekend(this.chooseDate)\r\n\t\t\t\t\tawait this.addToCart(isWeekend);\r\n\t\t\t\t\t// 调起支付\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\tutil.showErrorToast(err.errMsg)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 加入购物车\r\n\t\t\tasync addToCart(isWeekend) {\r\n\t\t\t\tlet checkedProduct = this.getCheckedProductItem(this.getCheckedSpecKey());\r\n\t\t\t\t// console.log(checkedProduct);\r\n\t\t\t\t// return;\r\n\t\t\t\tif (checkedProduct.length == 0) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '没选择好噢~',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 3000\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tawait util.request(\r\n\t\t\t\t\tapi.CartAdd, {\r\n\t\t\t\t\t\tgoodsId: this.id,\r\n\t\t\t\t\t\t// 该票的张数\r\n\t\t\t\t\t\tnumber: this.number,\r\n\t\t\t\t\t\t// 该票的id\r\n\t\t\t\t\t\tproductId: checkedProduct[0].id,\r\n\t\t\t\t\t\t// category_id??\r\n\t\t\t\t\t\tcategory_id: this.goods.category_id,\r\n\t\t\t\t\t\tisWeekend,\r\n\t\t\t\t\t\tcertification: JSON.stringify([{choosetime: this.chooseDate}])\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'POST'\r\n\t\t\t\t).then(res => {\r\n\t\t\t\t\tlet _res = res;\r\n\r\n\t\t\t\t\tif (_res.errno == 0) {\r\n\t\t\t\t\t\tthis.naviTo();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\timage: '/static/static/images/icon_error.png',\r\n\t\t\t\t\t\t\ttitle: _res.errmsg,\r\n\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// 购物车置空\r\n\t\t\tasync goodsClear() {\r\n\t\t\t\tawait util.request(\r\n\t\t\t\t\tapi.goodsClear, {},\r\n\t\t\t\t\t'GET'\r\n\t\t\t\t)\r\n\t\t\t},\r\n\r\n\t\t\t// 删除购物车中的票类商品\r\n\t\t\tasync productDlete() {\r\n\t\t\t\tawait util.request(\r\n\t\t\t\t\tapi.productDlete, {\r\n\t\t\t\t\t\tgoods_id: this.id\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'POST'\r\n\t\t\t\t)\r\n\t\t\t},\r\n\r\n\t\t\t// 调起支付\r\n\t\t\tsubmitOrder() {\r\n\t\t\t\t// if (this.addressId <= 0) {\r\n\t\t\t\t// \tutil.showErrorToast('请选择收货地址');\r\n\t\t\t\t// \treturn false;\r\n\t\t\t\t// }\r\n\r\n\t\t\t\tutil.request(\r\n\t\t\t\t\tapi.OrderSubmit, {\r\n\t\t\t\t\t\taddressId: this.addressId,\r\n\t\t\t\t\t\tcouponId: this.couponId,\r\n\t\t\t\t\t\t// category_id??\r\n\t\t\t\t\t\tcategory_id: this.category_id,\r\n\t\t\t\t\t\t// 是否需要地址\r\n\t\t\t\t\t\tisNoNeedAddress: this.ticketInfo.ticketType == '电子票' ? true : false,\r\n\t\t\t\t\t\t// 联系信息\r\n\t\t\t\t\t\tname: this.contactInfo.name,\r\n\t\t\t\t\t\tphone: this.contactInfo.phone,\r\n\t\t\t\t\t\t// 证件信息\r\n\t\t\t\t\t\t// certification: JSON.stringify(this.certificationInfo),\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'POST'\r\n\t\t\t\t).then((res) => {\r\n\t\t\t\t\tif (res.errno === 0) {\r\n\t\t\t\t\t\tconst orderId = res.data.orderInfo.id;\r\n\t\t\t\t\t\tpay.payOrder(parseInt(orderId))\r\n\t\t\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\turl: '/pages/payResult/payResult?status=1&orderId=' +\r\n\t\t\t\t\t\t\t\t\t\torderId\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.catch((res) => {\r\n\t\t\t\t\t\t\t\tuni.redirectTo({\r\n\t\t\t\t\t\t\t\t\turl: '/pages/payResult/payResult?status=0&orderId=' +\r\n\t\t\t\t\t\t\t\t\t\torderId\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tutil.showErrorToast('下单失败');\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tutil.showErrorToast('下单失败');\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\thandleTime(a, b) {\r\n\t\t\t\tlet start = new Date(a);\r\n\t\t\t\tlet end = new Date(b);\r\n\t\t\t\tconst handle = (n) => {\r\n\t\t\t\t\treturn n.toString().length > 1 ? n : `0${n}`\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet result = [];\r\n\t\t\t\twhile (start <= end) {\r\n\t\t\t\t\tlet month = start.getMonth() + 1;\r\n\t\t\t\t\tlet date = start.getDate();\r\n\t\t\t\t\tlet year = start.getFullYear();\r\n\t\t\t\t\tresult.push(`${year}-${handle(month)}-${handle(date)}`);\r\n\t\t\t\t\tstart.setDate(start.getDate() + 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result\r\n\t\t\t\t// console.log(result);\r\n\r\n\t\t\t},\r\n\t\t\tconfirm(e) {\r\n\t\t\t\t// clog\r\n\t\t\t\tconsole.log(e.extraInfo, \"什么情况\");\r\n\t\t\t\tconsole.log(this.timearr, \"这里错了？\");\r\n\t\t\t\tthis.chooseDate = e.fulldate;\r\n\t\t\t\t// this.retail_price = e.extraInfo.info.replace(\"￥\", \"\");\r\n\t\t\t\tconst event = {\r\n\t\t\t\t\tcurrentTarget: {\r\n\t\t\t\t\t\tdataset: {\r\n\t\t\t\t\t\t\tnameId: e.extraInfo.specification_id,\r\n\t\t\t\t\t\t\tvalueId: this.timearr[0].id,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.clickSkuValue(event, true);\r\n\t\t\t},\r\n\t\t\tisWeekend(date) {\r\n\t\t\t\tconst dayOfWeek = new Date(date).getDay();\r\n\t\t\t\treturn dayOfWeek === 6 || dayOfWeek === 0;\r\n\t\t\t},\r\n\t\t\tgetGoodsInfo: function() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tutil.request(api.GoodsDetail, {\r\n\t\t\t\t\tid: that.id\r\n\t\t\t\t}).then(function(res) {\r\n\t\t\t\t\tif (res.errno === 0) {\r\n\t\t\t\t\t\tif (res.data.info.category_id == 1036010) {\r\n\t\t\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\t\t\tbuyText: \"选择规格\"\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst specificationList = res.data.specificationList;\r\n\t\t\t\t\t\tconst shiJian = specificationList.filter(item => {\r\n\t\t\t\t\t\t\treturn item.name == '时间'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t// console.log(specificationList, shiJian);\r\n\t\t\t\t\t\t// shiJian 格式： [{},{}]\r\n\t\t\t\t\t\tlet shiJianArr = [];\r\n\t\t\t\t\t\tfor (let iitem of shiJian) {\r\n\t\t\t\t\t\t\tiitem = iitem.valueList.map(i => {\r\n\t\t\t\t\t\t\t\t// \"xxx & xxx\" => [xxx, xxx]\r\n\t\t\t\t\t\t\t\tconst [day1, day2] = i.value.split(\"&\");\r\n\t\t\t\t\t\t\t\ti.value = that.handleTime(day1, day2);\r\n\t\t\t\t\t\t\t\tconsole.log(i.id);\r\n\t\t\t\t\t\t\t\tconst retail_price = that.getRetailPrice(res.data.productList, i.id)\r\n\t\t\t\t\t\t\t\tconst weekend_price = that.getWeekendPrice(res.data.productList, i.id)\r\n\t\t\t\t\t\t\t\ti.value.map(j => {\r\n\t\t\t\t\t\t\t\t\tif (that.isWeekend(j)) {\r\n\t\t\t\t\t\t\t\t\t\tshiJianArr.push({\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: j,\r\n\t\t\t\t\t\t\t\t\t\t\tdate: j,\r\n\t\t\t\t\t\t\t\t\t\t\tid: i.id,\r\n\t\t\t\t\t\t\t\t\t\t\tspecification_id: i.specification_id,\r\n\t\t\t\t\t\t\t\t\t\t\tname: i.name,\r\n\t\t\t\t\t\t\t\t\t\t\tgoods_id: i.goods_id,\r\n\t\t\t\t\t\t\t\t\t\t\tinfo: (\"￥\" + weekend_price)\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tshiJianArr.push({\r\n\t\t\t\t\t\t\t\t\t\t\tgoods_id: i.goods_id,\r\n\t\t\t\t\t\t\t\t\t\t\tid: i.id,\r\n\t\t\t\t\t\t\t\t\t\t\tname: i.name,\r\n\t\t\t\t\t\t\t\t\t\t\tspecification_id: i.specification_id,\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: j,\r\n\t\t\t\t\t\t\t\t\t\t\tdate: j,\r\n\t\t\t\t\t\t\t\t\t\t\tinfo: \"￥\" + retail_price\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// for(let )\r\n\t\t\t\t\t\t// console.log(shiJianArr);\r\n\t\t\t\t\t\t// specificationList.forEach(item => {\r\n\t\t\t\t\t\t// \tif (item.name == '时间') {\r\n\t\t\t\t\t\t// \t\titem.valueList = shiJianArr;\r\n\t\t\t\t\t\t// \t\tconsole.log(item);\r\n\t\t\t\t\t\t// \t}\r\n\t\t\t\t\t\t// })\r\n\t\t\t\t\t\t// console.log(specificationList);\r\n\r\n\t\t\t\t\t\tspecificationList.sort(function(a, b) {\r\n\t\t\t\t\t\t\tif (a.name === '时间') {\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\t\tgoods: res.data.info,\r\n\t\t\t\t\t\t\tgallery: res.data.gallery,\r\n\t\t\t\t\t\t\tattribute: res.data.attribute,\r\n\t\t\t\t\t\t\tissueList: res.data.issue,\r\n\t\t\t\t\t\t\tcomment: res.data.comment,\r\n\t\t\t\t\t\t\tbrand: res.data.brand,\r\n\t\t\t\t\t\t\tspecificationList: specificationList,\r\n\t\t\t\t\t\t\t// specificationListCopy: JSON.parse(JSON.stringify(specificationList)),\r\n\t\t\t\t\t\t\tproductList: res.data.productList,\r\n\t\t\t\t\t\t\tuserHasCollect: res.data.userHasCollect,\r\n\t\t\t\t\t\t\ttimearr: shiJianArr,\r\n\t\t\t\t\t\t\ttimearrCopy: shiJianArr\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tif (res.data.userHasCollect == 1) {\r\n\t\t\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\t\t\tcollectBackImage: that.hasCollectImage\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\t\t\tcollectBackImage: that.noCollectImage\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//WxParse.wxParse('goodsDetail', 'html', res.data.info.goods_desc, that)\r\n\t\t\t\t\t\tthat.article_goodsDetail = that.escape2Html(res.data.info.goods_desc);\r\n\t\t\t\t\t\tthat.getGoodsRelated();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tgetGoodsRelated: function() {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tutil.request(api.GoodsRelated, {\r\n\t\t\t\t\tid: that.id\r\n\t\t\t\t}).then(function(res) {\r\n\t\t\t\t\tif (res.errno === 0) {\r\n\t\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\t\trelatedGoods: res.data.goodsList\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tclickSkuValue: function(event, state = false) {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet specNameId = event.currentTarget.dataset.nameId;\r\n\t\t\t\tlet specValueId = event.currentTarget.dataset.valueId; //判断是否可以点击\r\n\t\t\t\t!state && (this.chooseId = specValueId);\r\n\t\t\t\t// event function\r\n\t\t\t\t// if(event)\r\n\t\t\t\t// if(state) {\r\n\t\t\t\t// \tthis.chooseDate = \"选择日期\";\r\n\t\t\t\t// }\r\n\t\t\t\t!state && (this.chooseDate = \"选择日期\");\r\n\t\t\t\t// this.specificationList = JSON.parse(JSON.stringify(this.specificationListCopy));\r\n\t\t\t\t//TODO 性能优化，可在wx:for中添加index，可以直接获取点击的属性名和属性值，不用循环\r\n\r\n\t\t\t\tlet _specificationList = this.specificationList;\r\n\t\t\t\t// this. \r\n\t\t\t\t// console.log(specValueId, \"lkNCjwncjNJ\");\r\n\t\t\t\t// for (let i = 0; i < _specificationList.length; i++) {\r\n\t\t\t\t// \tif (_specificationList[i].specification_id == specNameId) {\r\n\t\t\t\t// \t\tfor (let j = 0; j < _specificationList[i].valueList.length; j++) {\r\n\t\t\t\t// \t\t\tif (_specificationList[i].valueList[j].id == specValueId) {\r\n\t\t\t\t// \t\t\t\t//如果已经选中，则反选\r\n\t\t\t\t// \t\t\t\tif (_specificationList[i].valueList[j].checked) {\r\n\t\t\t\t// \t\t\t\t\t_specificationList[i].valueList[j].checked = false;\r\n\t\t\t\t// \t\t\t\t} else {\r\n\t\t\t\t// \t\t\t\t\t_specificationList[i].valueList[j].checked = true;\r\n\t\t\t\t// \t\t\t\t}\r\n\t\t\t\t// \t\t\t} else {\r\n\t\t\t\t// \t\t\t\t_specificationList[i].valueList[j].checked = false;\r\n\t\t\t\t// \t\t\t}\r\n\t\t\t\t// \t\t}\r\n\t\t\t\t// \t}\r\n\t\t\t\t// }\r\n\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tspecificationList: that.setChecked(_specificationList, specValueId, specNameId)\r\n\t\t\t\t}); //重新计算spec改变后的信息\r\n\r\n\t\t\t\tthis.changeSpecInfo(); //重新计算哪些值不可以点击\r\n\t\t\t},\r\n\r\n\t\t\tfindId() {\r\n\t\t\t\tconst productList = this.productList;\r\n\t\t\t\tconst id = this.chooseId;\r\n\t\t\t\tconst result = productList.find(item => item.goods_specification_ids && item.goods_specification_ids.split(\r\n\t\t\t\t\t'_')[0] === String(id));\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\tconst otherId = result.goods_specification_ids.split('_')[1];\r\n\t\t\t\t\t// console.log(otherId); // 385\r\n\t\t\t\t\treturn otherId\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t//获取选中的规格信息\r\n\t\t\tgetCheckedSpecValue: function() {\r\n\t\t\t\tlet checkedValues = [];\r\n\t\t\t\tconsole.log(this.specificationList, 234)\r\n\t\t\t\tlet _specificationList = this.specificationList;\r\n\r\n\t\t\t\tfor (let i = 0; i < _specificationList.length; i++) {\r\n\t\t\t\t\tlet _checkedObj = {\r\n\t\t\t\t\t\tnameId: _specificationList[i].specification_id,\r\n\t\t\t\t\t\tvalueId: 0,\r\n\t\t\t\t\t\tvalueText: ''\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tfor (let j = 0; j < _specificationList[i].valueList.length; j++) {\r\n\t\t\t\t\t\tconsole.log(_specificationList[i].valueList[j]);\r\n\t\t\t\t\t\tif (_specificationList[i].valueList[j].checked) {\r\n\t\t\t\t\t\t\t_checkedObj.valueId = _specificationList[i].valueList[j].id;\r\n\t\t\t\t\t\t\t_checkedObj.valueText = _specificationList[i].valueList[j].value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcheckedValues.push(_checkedObj);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn checkedValues;\r\n\t\t\t},\r\n\t\t\tsetChecked(specificationList, id, nameId) {\r\n\t\t\t\tlet targetSpecification = specificationList.find(item => item.specification_id === nameId);\r\n\t\t\t\tif (targetSpecification) {\r\n\t\t\t\t\ttargetSpecification.valueList.forEach(item => {\r\n\t\t\t\t\t\tif (item.id === id) {\r\n\t\t\t\t\t\t\titem[\"checked\"] = true;\r\n\t\t\t\t\t\t\t// console.log(item, \"陌\", id, nameId);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\titem[\"checked\"] = false;\r\n\t\t\t\t\t\t\t// console.log(item, \"佛\", id, nameId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn specificationList;\r\n\t\t\t},\r\n\t\t\t//根据已选的值，计算其它值的状态\r\n\t\t\tsetSpecValueStatus: function() {},\r\n\r\n\t\t\t//判断规格是否选择完整\r\n\t\t\tisCheckedAllSpec: function() {\r\n\t\t\t\treturn !this.getCheckedSpecValue().some(function(v) {\r\n\t\t\t\t\tif (v.valueId == 0) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tgetCheckedSpecKey: function() {\r\n\t\t\t\tconsole.log(231, this.getCheckedSpecValue())\r\n\t\t\t\tlet checkedValue = this.getCheckedSpecValue().map(function(v) {\r\n\t\t\t\t\treturn v.valueId;\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(233, checkedValue)\r\n\t\t\t\treturn checkedValue.join('_');\r\n\t\t\t},\r\n\r\n\t\t\tchangeSpecInfo: function() {\r\n\t\t\t\tlet checkedNameValue = this.getCheckedSpecValue(); //设置选择的信息\r\n\t\t\t\tconsole.log(checkedNameValue);\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tlet checkedValue = checkedNameValue\r\n\t\t\t\t\t.filter(function(v) {\r\n\t\t\t\t\t\tif (v.valueId != 0) {\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.map(function(v) {\r\n\t\t\t\t\t\tconsole.log(v);\r\n\t\t\t\t\t\tif (v.nameId == 8) {\r\n\t\t\t\t\t\t\treturn that.chooseDate\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn v.valueText;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t// console.log(checkedValue);\r\n\r\n\r\n\t\t\t\tthis.retail_price = '此类暂时没有'\r\n\t\t\t\tlet checkedProduct = this.getCheckedProductItem(this.getCheckedSpecKey());\r\n\r\n\r\n\r\n\t\t\t\tconsole.log(checkedProduct);\r\n\r\n\t\t\t\tif (checkedProduct.length > 0) {\r\n\t\t\t\t\tthis.retail_price = checkedProduct[0].retail_price\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (checkedValue.length > 0) {\r\n\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\tcheckedSpecText: checkedValue.join('　')\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\tcheckedSpecText: '请选择规格数量'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetCheckedProductItem: function(key) {\r\n\t\t\t\tconsole.log(123, key)\r\n\r\n\t\t\t\tif (this.productList.length === 1) {\r\n\t\t\t\t\treturn this.productList\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.productList.filter(function(v) {\r\n\t\t\t\t\t// console.log(v.goods_specification_ids, key)\r\n\t\t\t\t\t// console.log(v.goods_specification_ids.split('_').sort(), key.split('_').sort())\r\n\t\t\t\t\tif (v.goods_specification_ids && (JSON.stringify(v.goods_specification_ids.split('_')\r\n\t\t\t\t\t\t\t.sort()) === JSON.stringify(key.split(\r\n\t\t\t\t\t\t\t'_').sort()))) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\tswitchAttrPop: function() {\r\n\t\t\t\tif (this.openAttr == false) {\r\n\t\t\t\t\tthis.setData({\r\n\t\t\t\t\t\topenAttr: !this.openAttr,\r\n\t\t\t\t\t\tbuyText: \"立即购买\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tcloseAttr: function() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\topenAttr: false,\r\n\t\t\t\t\tbuyText: \"选择规格\"\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\taddCannelCollect: function() {\r\n\t\t\t\tlet that = this; //添加或是取消收藏\r\n\r\n\t\t\t\tutil.request(\r\n\t\t\t\t\tapi.CollectAddOrDelete, {\r\n\t\t\t\t\t\ttypeId: 0,\r\n\t\t\t\t\t\tvalueId: this.id\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'POST'\r\n\t\t\t\t).then(function(res) {\r\n\t\t\t\t\tlet _res = res;\r\n\r\n\t\t\t\t\tif (_res.errno == 0) {\r\n\t\t\t\t\t\tif (_res.data.type == 'add') {\r\n\t\t\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\t\t\tcollectBackImage: that.hasCollectImage\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthat.setData({\r\n\t\t\t\t\t\t\t\tcollectBackImage: that.noCollectImage\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\timage: '/static/static/images/icon_error.png',\r\n\t\t\t\t\t\t\ttitle: _res.errmsg,\r\n\t\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\r\n\t\t\topenCartPage: function() {\r\n\t\t\t\tuni.switchTab({\r\n\t\t\t\t\turl: '/pages/cart/cart'\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t// addToCart: function() {\r\n\t\t\t// \tvar that = this;\r\n\r\n\t\t\t// \tif (this.openAttr === false) {\r\n\t\t\t// \t\t//打开规格选择窗口\r\n\t\t\t// \t\tthis.setData({\r\n\t\t\t// \t\t\topenAttr: !this.openAttr\r\n\t\t\t// \t\t});\r\n\t\t\t// \t} else {\r\n\t\t\t// \t\t//提示选择完整规格\r\n\t\t\t// \t\tif (!this.isCheckedAllSpec()) {\r\n\t\t\t// \t\t\tuni.showToast({\r\n\t\t\t// \t\t\t\timage: '/static/static/images/icon_error.png',\r\n\t\t\t// \t\t\t\ttitle: '请选择规格',\r\n\t\t\t// \t\t\t\tmask: true\r\n\t\t\t// \t\t\t});\r\n\t\t\t// \t\t\treturn false;\r\n\t\t\t// \t\t} //根据选中的规格，判断是否有对应的sku信息\r\n\r\n\t\t\t// \t\tlet checkedProduct = this.getCheckedProductItem(this.getCheckedSpecKey());\r\n\r\n\r\n\t\t\t// \t\tconsole.log(checkedProduct)\r\n\t\t\t// \t\tif (!checkedProduct || checkedProduct.length <= 0) {\r\n\t\t\t// \t\t\t//找不到对应的product信息，提示没有库存\r\n\t\t\t// \t\t\tuni.showToast({\r\n\t\t\t// \t\t\t\timage: '/static/static/images/icon_error.png',\r\n\t\t\t// \t\t\t\ttitle: '库存不足',\r\n\t\t\t// \t\t\t\tmask: true\r\n\t\t\t// \t\t\t});\r\n\t\t\t// \t\t\treturn false;\r\n\t\t\t// \t\t} //验证库存\r\n\r\n\t\t\t// \t\tif (checkedProduct.goods_number < this.number) {\r\n\t\t\t// \t\t\t//找不到对应的product信息，提示没有库存\r\n\t\t\t// \t\t\tuni.showToast({\r\n\t\t\t// \t\t\t\timage: '/static/static/images/icon_error.png',\r\n\t\t\t// \t\t\t\ttitle: '库存不足',\r\n\t\t\t// \t\t\t\tmask: true\r\n\t\t\t// \t\t\t});\r\n\t\t\t// \t\t\treturn false;\r\n\t\t\t// \t\t}\r\n\r\n\t\t\t// \t\t//添加到购物车\r\n\t\t\t// \t\tutil.request(\r\n\t\t\t// \t\t\tapi.CartAdd, {\r\n\t\t\t// \t\t\t\tgoodsId: this.goods.id,\r\n\t\t\t// \t\t\t\tnumber: this.number,\r\n\t\t\t// \t\t\t\tproductId: checkedProduct[0].id\r\n\t\t\t// \t\t\t},\r\n\t\t\t// \t\t\t'POST'\r\n\t\t\t// \t\t).then(function(res) {\r\n\t\t\t// \t\t\tlet _res = res;\r\n\r\n\t\t\t// \t\t\tif (_res.errno == 0) {\r\n\t\t\t// \t\t\t\tuni.showToast({\r\n\t\t\t// \t\t\t\t\ttitle: '添加成功'\r\n\t\t\t// \t\t\t\t});\r\n\t\t\t// \t\t\t\tthat.setData({\r\n\t\t\t// \t\t\t\t\topenAttr: !that.openAttr,\r\n\t\t\t// \t\t\t\t\tcartGoodsCount: _res.data.cartTotal.goodsCount\r\n\t\t\t// \t\t\t\t});\r\n\t\t\t// \t\t\t} else {\r\n\t\t\t// \t\t\t\tuni.showToast({\r\n\t\t\t// \t\t\t\t\timage: '/static/static/images/icon_error.png',\r\n\t\t\t// \t\t\t\t\ttitle: _res.errmsg,\r\n\t\t\t// \t\t\t\t\tmask: true\r\n\t\t\t// \t\t\t\t});\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t});\r\n\t\t\t// \t}\r\n\t\t\t// },\r\n\r\n\t\t\tcutNumber: function() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tnumber: this.number - 1 > 1 ? this.number - 1 : 1\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\taddNumber: function() {\r\n\t\t\t\tthis.setData({\r\n\t\t\t\t\tnumber: this.number + 1\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style>\r\n\t@import url(\"./goods.css\");\r\n</style>\n","import mod from \"-!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./goods.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./goods.vue?vue&type=style&index=0&lang=css&\""],"sourceRoot":""}